var fileNm = "dbjs/_CATEGORY.SITE/allList.dbjs";
Rh2Log.log( "-- [ S ] - " + fileNm );

//----------------------------------------------------------------------------------------------------;

Rh2Log.log( "-- 요약 : 사이트 목록 조회" );
Rh2Log.log( "----------" );
Rh2Log.log( "-- 입력데이터 : NaN" );
Rh2Log.log( "----------" );
Rh2Log.log( "-- 전제조건 : _CATEGORY.SITE, _CATEGORY.COUNTRY 존재" );
Rh2Log.log( "----------" );
Rh2Log.log( "-- 예상결과 : _CATEGORY.SITE, _CATEGORY.COUNTRY 를 조회하여 목록 반환" );

//----------------------------------------------------------------------------------------------------;

//To Get Execution Time;
var _ST = Date.now();

//----------------------------------------------------------------------------------------------------;

//	REQUIRE;

//----------------------------------------------------------------------------------------------------;

//----------------------------------------------------------------------------------------------------;

//	FUNCTION;

//----------------------------------------------------------------------------------------------------;

//----------------------------------------------------------------------------------------------------;

//	DATABASE;

//----------------------------------------------------------------------------------------------------;

var _db$_CATEGORY = db.getSiblingDB( "_CATEGORY" );

//----------------------------------------------------------------------------------------------------;

//	COLLECTION;

//----------------------------------------------------------------------------------------------------;

var _col$COUNTRY = _db$_CATEGORY.getCollection( "COUNTRY" );
var _col$SITE = _db$_CATEGORY.getCollection( "SITE" );

//----------------------------------------------------------------------------------------------------;

//	DOCUMENT;

//----------------------------------------------------------------------------------------------------;

var _doc$COUNTRY;

//----------------------------------------------------------------------------------------------------;

//	PARAMETER;

//----------------------------------------------------------------------------------------------------;

var _p_find__country = { cd : "" };
var _p_find__site = { _d : 1 };
var R = {};

//----------------------------------------------------------------------------------------------------;

//	VALIDATION;

//----------------------------------------------------------------------------------------------------;

//----------------------------------------------------------------------------------------------------;

//	LOGIC;

//----------------------------------------------------------------------------------------------------;

var result = [];
var totalCount = 0;

_col$SITE.find( _p_find__site ).forEach( function( doc ){

	if( doc.cd$COUNTRY )
	{
		_p_find__country.cd = doc.cd$COUNTRY;
		_doc$COUNTRY = _col$COUNTRY.findOne( _p_find__country );
		if( _doc$COUNTRY )
		{
			doc.c = _doc$COUNTRY.c;
			doc.area0 = _doc$COUNTRY.area0;
			doc.area1 = _doc$COUNTRY.area1;
		}
	}

	result.push( doc );
});
totalCount = result.length;

//----------------------------------------------------------------------------------------------------;

R.r = 0;
R.m = "OK";
R.data = result;
R.totalCount = totalCount;
//R.executionTime = Date.now() - _ST;

Rh2Log.log( "-- [ E ] - " + fileNm );

return R;